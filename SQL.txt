SELECT
    C.NAME AS CUSTOMER_NAME,
    M.NAME AS MANAGER_NAME
FROM
    CUSTOMERS C
JOIN
    MANAGERS M ON C.MANAGERID = M.ID
JOIN
    ORDERS O ON C.ID = O.CUSTOMERID
WHERE
    O.DATE >= '2023-01-01'
GROUP BY
    C.ID, M.ID
HAVING
    SUM(O.AMOUNT) > 1000;
